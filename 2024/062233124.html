<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.2.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"lem0nkdking.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="主动信息搜集本篇文章来自于GG师傅的课程（全国第一WEB课程），仅用作自己学习记录。以后会慢慢输出自己的文章，感兴趣的可以去找GG师傅咨询课程。 参考链接：https:&#x2F;&#x2F;www.sqlsec.com&#x2F;2017&#x2F;07&#x2F;nmap.html GG师傅博客：https:&#x2F;&#x2F;www.sqlsec.com&#x2F; 端口扫描基本概念渗透测试中的端口扫描是指通过网络探测技术，识别目标系统上开放的网络端口及其对应的服务">
<meta property="og:type" content="article">
<meta property="og:title" content="端口扫描">
<meta property="og:url" content="https://lem0nkdking.github.io/2024/062233124.html">
<meta property="og:site_name" content="Glock.09&#39;s blogs">
<meta property="og:description" content="主动信息搜集本篇文章来自于GG师傅的课程（全国第一WEB课程），仅用作自己学习记录。以后会慢慢输出自己的文章，感兴趣的可以去找GG师傅咨询课程。 参考链接：https:&#x2F;&#x2F;www.sqlsec.com&#x2F;2017&#x2F;07&#x2F;nmap.html GG师傅博客：https:&#x2F;&#x2F;www.sqlsec.com&#x2F; 端口扫描基本概念渗透测试中的端口扫描是指通过网络探测技术，识别目标系统上开放的网络端口及其对应的服务">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219376.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219046.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219562.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406041802484.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219993.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219781.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219829.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219219.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219029.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219266.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406041528194.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219535.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219674.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219529.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219090.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219107.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219814.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219117.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219302.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219603.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219398.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219162.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219354.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219533.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219073.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219747.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219746.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219766.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219770.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219449.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219631.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219109.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219809.png">
<meta property="og:image" content="https://web.sqlsec.com/attack/assets/1/image-12.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219575.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219983.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219380.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219345.png">
<meta property="og:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219542.png">
<meta property="article:published_time" content="2024-06-22T03:46:50.000Z">
<meta property="article:modified_time" content="2024-06-22T04:34:55.123Z">
<meta property="article:author" content="Glock.09">
<meta property="article:tag" content="主动信息收集">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219376.png">


<link rel="canonical" href="https://lem0nkdking.github.io/2024/062233124.html">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://lem0nkdking.github.io/2024/062233124.html","path":"2024/062233124.html","title":"端口扫描"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>端口扫描 | Glock.09's blogs</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Glock.09's blogs</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">看似不起波澜的日复一日，一定会在某一天，让你看到坚持的意义</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%BB%E5%8A%A8%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86"><span class="nav-number">1.</span> <span class="nav-text">主动信息搜集</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F"><span class="nav-number">1.1.</span> <span class="nav-text">端口扫描</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="nav-number">1.1.1.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86"><span class="nav-number">1.1.2.</span> <span class="nav-text">基本原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TCP-%E6%8A%A5%E5%A4%B4%E4%BF%A1%E6%81%AF"><span class="nav-number">1.1.3.</span> <span class="nav-text">TCP 报头信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TCP-%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B"><span class="nav-number">1.1.4.</span> <span class="nav-text">TCP 三次握手</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TCP-%E5%85%A8%E5%BC%80%E6%94%BE%E6%89%AB%E6%8F%8F"><span class="nav-number">1.1.5.</span> <span class="nav-text">TCP 全开放扫描</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TCP-%E5%8D%8A%E5%BC%80%E6%94%BE%E6%89%AB%E6%8F%8F"><span class="nav-number">1.1.6.</span> <span class="nav-text">TCP 半开放扫描</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UDP-%E6%89%AB%E6%8F%8F"><span class="nav-number">1.1.7.</span> <span class="nav-text">UDP 扫描</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%8F%A3"><span class="nav-number">1.1.8.</span> <span class="nav-text">服务端口</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81-TCP-%E7%AB%AF%E5%8F%A3"><span class="nav-number">1.1.8.1.</span> <span class="nav-text">常见 TCP 端口</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81-UDP-%E7%AB%AF%E5%8F%A3"><span class="nav-number">1.1.8.2.</span> <span class="nav-text">常见 UDP 端口</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#DNS-%E7%AB%AF%E5%8F%A3%E8%AF%A6%E8%A7%A3"><span class="nav-number">1.1.8.3.</span> <span class="nav-text">DNS 端口详解</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8D%8F%E8%AE%AE%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.1.8.3.1.</span> <span class="nav-text">协议类型</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-1"><span class="nav-number">1.1.8.3.2.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#hosts-%E6%96%87%E4%BB%B6"><span class="nav-number">1.1.8.3.3.</span> <span class="nav-text">hosts 文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#DNS-%E5%9F%9F%E4%BC%A0%E9%80%81"><span class="nav-number">1.1.8.3.4.</span> <span class="nav-text">DNS 域传送</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%A9%E7%A0%81%E9%95%BF%E5%BA%A6"><span class="nav-number">1.1.9.</span> <span class="nav-text">掩码长度</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7"><span class="nav-number">1.1.10.</span> <span class="nav-text">扫描工具</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#nmap"><span class="nav-number">1.1.10.1.</span> <span class="nav-text">nmap</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="nav-number">1.1.10.1.1.</span> <span class="nav-text">基本操作</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E5%BF%AB%E9%80%9F%E6%89%AB%E6%8F%8F"><span class="nav-number">1.1.10.1.1.1.</span> <span class="nav-text">基本快速扫描</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%BF%AB%E9%80%9F%E6%89%AB%E6%8F%8F%E5%A4%9A%E4%B8%AA%E7%9B%AE%E6%A0%87"><span class="nav-number">1.1.10.1.1.2.</span> <span class="nav-text">快速扫描多个目标</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%AF%A6%E7%BB%86%E6%8F%8F%E8%BF%B0%E8%BE%93%E5%87%BA%E6%89%AB%E6%8F%8F"><span class="nav-number">1.1.10.1.1.3.</span> <span class="nav-text">详细描述输出扫描</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%8C%87%E5%AE%9A%E7%AB%AF%E5%8F%A3%E5%92%8C%E8%8C%83%E5%9B%B4%E6%89%AB%E6%8F%8F"><span class="nav-number">1.1.10.1.1.4.</span> <span class="nav-text">指定端口和范围扫描</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%89%AB%E6%8F%8F%E9%99%A4%E8%BF%87%E6%9F%90%E4%B8%80%E4%B8%AA-ip-%E5%A4%96%E7%9A%84%E6%89%80%E6%9C%89%E5%AD%90%E7%BD%91%E4%B8%BB%E6%9C%BA"><span class="nav-number">1.1.10.1.1.5.</span> <span class="nav-text">扫描除过某一个 ip 外的所有子网主机</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%89%AB%E6%8F%8F%E9%99%A4%E8%BF%87%E6%9F%90%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84-ip-%E5%A4%96%E7%9A%84%E5%AD%90%E7%BD%91%E4%B8%BB%E6%9C%BA"><span class="nav-number">1.1.10.1.1.6.</span> <span class="nav-text">扫描除过某一个文件中的 ip 外的子网主机</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%98%BE%E7%A4%BA%E6%89%AB%E6%8F%8F%E7%9A%84%E6%89%80%E6%9C%89%E4%B8%BB%E6%9C%BA%E7%9A%84%E5%88%97%E8%A1%A8"><span class="nav-number">1.1.10.1.1.7.</span> <span class="nav-text">显示扫描的所有主机的列表</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#sP-ping-%E6%89%AB%E6%8F%8F"><span class="nav-number">1.1.10.1.1.8.</span> <span class="nav-text">sP ping 扫描</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#sS-SYN-%E5%8D%8A%E5%BC%80%E6%94%BE%E6%89%AB%E6%8F%8F"><span class="nav-number">1.1.10.1.1.9.</span> <span class="nav-text">sS SYN 半开放扫描</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#sT-TCP-%E6%89%AB%E6%8F%8F"><span class="nav-number">1.1.10.1.1.10.</span> <span class="nav-text">sT TCP 扫描</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#sU-UDP-%E6%89%AB%E6%8F%8F"><span class="nav-number">1.1.10.1.1.11.</span> <span class="nav-text">sU UDP 扫描</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#sF-FIN-%E6%A0%87%E5%BF%97%E7%9A%84%E6%95%B0%E6%8D%AE%E5%8C%85%E6%89%AB%E6%8F%8F"><span class="nav-number">1.1.10.1.1.12.</span> <span class="nav-text">sF FIN 标志的数据包扫描</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#sV-Version-%E7%89%88%E6%9C%AC%E6%A3%80%E6%B5%8B%E6%89%AB%E6%8F%8F"><span class="nav-number">1.1.10.1.1.13.</span> <span class="nav-text">sV Version 版本检测扫描</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#O-OS-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%B1%BB%E5%9E%8B%E7%9A%84%E6%8E%A2%E6%B5%8B"><span class="nav-number">1.1.10.1.1.14.</span> <span class="nav-text">O OS 操作系统类型的探测</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#osscan-guess-%E7%8C%9C%E6%B5%8B%E5%8C%B9%E9%85%8D%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F"><span class="nav-number">1.1.10.1.1.15.</span> <span class="nav-text">osscan-guess 猜测匹配操作系统</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#PN-No-ping-%E6%89%AB%E6%8F%8F"><span class="nav-number">1.1.10.1.2.</span> <span class="nav-text">PN No ping 扫描</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#T-%E8%AE%BE%E7%BD%AE%E6%97%B6%E9%97%B4%E6%A8%A1%E6%9D%BF"><span class="nav-number">1.1.10.1.3.</span> <span class="nav-text">T 设置时间模板</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%BD%91%E6%AE%B5%E6%89%AB%E6%8F%8F%E6%A0%BC%E5%BC%8F"><span class="nav-number">1.1.10.1.3.1.</span> <span class="nav-text">网段扫描格式</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E4%BB%8E%E6%96%87%E4%BB%B6%E4%B8%AD%E8%AF%BB%E5%8F%96%E9%9C%80%E8%A6%81%E6%89%AB%E6%8F%8F%E7%9A%84-IP-%E5%88%97%E8%A1%A8"><span class="nav-number">1.1.10.1.3.2.</span> <span class="nav-text">从文件中读取需要扫描的 IP 列表</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%B7%AF%E7%94%B1%E8%B7%9F%E8%B8%AA%E6%89%AB%E6%8F%8F"><span class="nav-number">1.1.10.1.3.3.</span> <span class="nav-text">路由跟踪扫描</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#A-OS-%E8%AF%86%E5%88%AB-%E7%89%88%E6%9C%AC%E6%8E%A2%E6%B5%8B-%E8%84%9A%E6%9C%AC%E6%89%AB%E6%8F%8F%E5%92%8C-traceroute-%E7%BB%BC%E5%90%88%E6%89%AB%E6%8F%8F"><span class="nav-number">1.1.10.1.3.4.</span> <span class="nav-text">A OS 识别 版本探测 脚本扫描和 traceroute 综合扫描</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4%E6%B7%B7%E5%90%88%E5%BC%8F%E6%89%AB%E6%8F%8F"><span class="nav-number">1.1.10.1.3.5.</span> <span class="nav-text">命令混合式扫描</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%BE%93%E5%87%BA%E6%A0%BC%E5%BC%8F"><span class="nav-number">1.1.10.1.3.6.</span> <span class="nav-text">输出格式</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Nmap-%E9%AB%98%E7%BA%A7%E7%94%A8%E6%B3%95%E4%B9%8B%E8%84%9A%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="nav-number">1.1.10.1.4.</span> <span class="nav-text">Nmap 高级用法之脚本使用</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%8C%89%E7%85%A7%E8%84%9A%E6%9C%AC%E5%88%86%E7%B1%BB%E8%BF%9B%E8%A1%8C%E6%89%AB%E6%8F%8F"><span class="nav-number">1.1.10.1.4.1.</span> <span class="nav-text">按照脚本分类进行扫描</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%85%B7%E4%BD%93%E8%84%9A%E6%9C%AC%E8%BF%9B%E8%A1%8C%E6%89%AB%E6%8F%8F"><span class="nav-number">1.1.10.1.4.2.</span> <span class="nav-text">使用具体脚本进行扫描</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E8%84%9A%E6%9C%AC%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B"><span class="nav-number">1.1.10.1.4.3.</span> <span class="nav-text">常用脚本使用案例</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%89%AB%E6%8F%8F%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E"><span class="nav-number">1.1.10.1.4.4.</span> <span class="nav-text">扫描服务器的常见漏洞</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%A3%80%E6%9F%A5-FTP-%E6%98%AF%E5%90%A6%E5%BC%80%E5%90%AF%E5%8C%BF%E5%90%8D%E7%99%BB%E9%99%86"><span class="nav-number">1.1.10.1.4.5.</span> <span class="nav-text">检查 FTP 是否开启匿名登陆</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%AF%B9-MySQL-%E8%BF%9B%E8%A1%8C%E6%9A%B4%E7%A0%B4%E8%A7%A3"><span class="nav-number">1.1.10.1.4.6.</span> <span class="nav-text">对 MySQL 进行暴破解</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%AF%B9-MSSQL-%E8%BF%9B%E8%A1%8C%E6%9A%B4%E7%A0%B4%E8%A7%A3"><span class="nav-number">1.1.10.1.4.7.</span> <span class="nav-text">对 MSSQL 进行暴破解</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%AF%B9-Oracle-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9B%E8%A1%8C%E6%9A%B4%E7%A0%B4%E8%A7%A3"><span class="nav-number">1.1.10.1.4.8.</span> <span class="nav-text">对 Oracle 数据库进行暴破解</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%AF%B9-pgSQL-%E7%9A%84%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3"><span class="nav-number">1.1.10.1.4.9.</span> <span class="nav-text">对 pgSQL 的暴力破解</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%AF%B9-SSH-%E8%BF%9B%E8%A1%8C%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3"><span class="nav-number">1.1.10.1.4.10.</span> <span class="nav-text">对 SSH 进行暴力破解</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%88%A9%E7%94%A8-DNS-%E8%BF%9B%E8%A1%8C%E5%AD%90%E5%9F%9F%E5%90%8D%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3"><span class="nav-number">1.1.10.1.4.11.</span> <span class="nav-text">利用 DNS 进行子域名暴力破解</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%A3%80%E6%9F%A5-VMWare-ESX%EF%BC%8CESXi-%E5%92%8C%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%88CVE-2009-3733%EF%BC%89%E4%B8%AD%E7%9A%84%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E"><span class="nav-number">1.1.10.1.4.12.</span> <span class="nav-text">检查 VMWare ESX，ESXi 和服务器（CVE-2009-3733）中的路径遍历漏洞</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2-VMware-%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%88vCenter%EF%BC%8CESX%EF%BC%8CESXi%EF%BC%89SOAP-API-%E4%BB%A5%E6%8F%90%E5%8F%96%E7%89%88%E6%9C%AC%E4%BF%A1%E6%81%AF%E3%80%82"><span class="nav-number">1.1.10.1.4.13.</span> <span class="nav-text">查询 VMware 服务器（vCenter，ESX，ESXi）SOAP API 以提取版本信息。</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8F%82%E6%95%B0%E8%AF%A6%E8%A7%A3"><span class="nav-number">1.1.10.1.5.</span> <span class="nav-text">参数详解</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E4%B8%BB%E6%9C%BA%E5%8F%91%E7%8E%B0"><span class="nav-number">1.1.10.1.5.1.</span> <span class="nav-text">主机发现</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%89%AB%E6%8F%8F%E6%8A%80%E5%B7%A7"><span class="nav-number">1.1.10.1.5.2.</span> <span class="nav-text">扫描技巧</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%8C%87%E5%AE%9A%E7%AB%AF%E5%8F%A3%E5%92%8C%E6%89%AB%E6%8F%8F%E9%A1%BA%E5%BA%8F"><span class="nav-number">1.1.10.1.5.3.</span> <span class="nav-text">指定端口和扫描顺序</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%9C%8D%E5%8A%A1%E7%89%88%E6%9C%AC%E8%AF%86%E5%88%AB"><span class="nav-number">1.1.10.1.5.4.</span> <span class="nav-text">服务版本识别</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%84%9A%E6%9C%AC%E6%89%AB%E6%8F%8F"><span class="nav-number">1.1.10.1.5.5.</span> <span class="nav-text">脚本扫描</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#OS-%E8%AF%86%E5%88%AB"><span class="nav-number">1.1.10.1.5.6.</span> <span class="nav-text">OS 识别</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E9%98%B2%E7%81%AB%E5%A2%99-IDS-%E8%BA%B2%E9%81%BF%E5%92%8C%E5%93%84%E9%AA%97"><span class="nav-number">1.1.10.1.5.7.</span> <span class="nav-text">防火墙 &#x2F; IDS 躲避和哄骗</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Nmap-%E8%BE%93%E5%87%BA"><span class="nav-number">1.1.10.1.5.8.</span> <span class="nav-text">Nmap 输出</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%85%B6%E4%BB%96-Nmap-%E9%80%89%E9%A1%B9"><span class="nav-number">1.1.10.1.5.9.</span> <span class="nav-text">其他 Nmap 选项</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Masscan"><span class="nav-number">1.1.10.2.</span> <span class="nav-text">Masscan</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E5%B7%A5%E5%85%B7"><span class="nav-number">1.1.10.3.</span> <span class="nav-text">其他工具</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#GG%E9%9D%B6%E5%9C%BA%E5%AE%9E%E6%88%98"><span class="nav-number">1.1.11.</span> <span class="nav-text">GG靶场实战</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Everything-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="nav-number">1.1.12.</span> <span class="nav-text">Everything 基本使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E8%A7%84%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86"><span class="nav-number">1.1.13.</span> <span class="nav-text">常规信息搜集</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E6%B3%95%E4%B8%80%EF%BC%9AChrome-%E5%AF%86%E7%A0%81%E5%87%AD%E6%8D%AE"><span class="nav-number">1.1.13.1.</span> <span class="nav-text">解法一：Chrome 密码凭据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E6%B3%95%E4%BA%8C%EF%BC%9A%E9%80%86%E5%A4%A9%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%A4%A9%E8%B5%8B"><span class="nav-number">1.1.13.2.</span> <span class="nav-text">解法二：逆天弱口令天赋</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9D%91%E7%82%B9%E6%80%BB%E7%BB%93"><span class="nav-number">1.2.</span> <span class="nav-text">坑点总结</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Glock.09"
      src="/images/avatar2.gif">
  <p class="site-author-name" itemprop="name">Glock.09</p>
  <div class="site-description" itemprop="description">鹏北海，凤朝阳</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">4</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://lem0nkdking.github.io/2024/062233124.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar2.gif">
      <meta itemprop="name" content="Glock.09">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Glock.09's blogs">
      <meta itemprop="description" content="鹏北海，凤朝阳">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="端口扫描 | Glock.09's blogs">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          端口扫描
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2024-06-22 11:46:50 / 修改时间：12:34:55" itemprop="dateCreated datePublished" datetime="2024-06-22T11:46:50+08:00">2024-06-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/WEB/" itemprop="url" rel="index"><span itemprop="name">WEB</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>19k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>17 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="主动信息搜集"><a href="#主动信息搜集" class="headerlink" title="主动信息搜集"></a>主动信息搜集</h1><p><strong>本篇文章来自于GG师傅的课程（全国第一WEB课程），仅用作自己学习记录。以后会慢慢输出自己的文章，感兴趣的可以去找GG师傅咨询课程。</strong></p>
<p>参考链接：<a target="_blank" rel="noopener" href="https://www.sqlsec.com/2017/07/nmap.html">https://www.sqlsec.com/2017/07/nmap.html</a></p>
<p>GG师傅博客：<a target="_blank" rel="noopener" href="https://www.sqlsec.com/">https://www.sqlsec.com/</a></p>
<h2 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h2><h3 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h3><p>渗透测试中的端口扫描是指通过网络探测技术，识别目标系统上开放的网络端口及其对应的服务。 但是随着互联网的成熟，大多数网站很少对外直接暴露过多的端口了：</p>
<p>所以渗透测试中，使用主动地端口扫描技术来收集的方式已经不是主流，端口扫描在内网当中使用场景更加广泛。</p>
<span id="more"></span>

<h3 id="基本原理"><a href="#基本原理" class="headerlink" title="基本原理"></a>基本原理</h3><p>端口扫描的基本原理主要涉及网络通信和协议，常基于 <code>TCP/IP</code> 协议栈，通过发送特定类型的网络包来探测目标系统的端口状态。</p>
<p>主要使用的协议有 <code>TCP</code>（传输控制协议）和 <code>UDP</code>（用户数据报协议）。</p>
<p>端口的数量</p>
<p>先说结论，计算机的端口数量上限为 65535 个。</p>
<p>这与计算机网络协议（TCP 和 UDP）的设计密切相关。</p>
<p>TCP 和 UDP 端口号在协议头中使用 16 位二进制数来表示。在 TCP 协议中，每个连接都需要一个唯一的端口号和 IP 地址来标识。由于 TCP 协议头中的端口号只有 16 位，因此本地端口个数最大只有 65536，端口 0 有特殊含义，不能使用。</p>
<p><a target="_blank" rel="noopener" href="https://web.sqlsec.com/0/assets/1/image-1.png"><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219376.png" alt="img"></a></p>
<h3 id="TCP-报头信息"><a href="#TCP-报头信息" class="headerlink" title="TCP 报头信息"></a>TCP 报头信息</h3><p>TCP 报头信息中有六个控制位(标志位)，分别是：SYN、ACK、PSH、FIN、RST 和 URG。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">|          源端口号          |            目的端口号               |</span><br><span class="line">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">|                        Sequence Number                        |</span><br><span class="line">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">|                    Acknowledgment Number                      |</span><br><span class="line">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">|  Data |Reser-|       |U|A|P|R|S|F|                            |</span><br><span class="line">| Offset|ved   | Flags |R|C|S|S|Y|I|            Window          |</span><br><span class="line">|       |      |       |G|K|H|T|N|N|                            |</span><br><span class="line">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">|           Checksum            |         Urgent Pointer        |</span><br><span class="line">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">|                    Options                    |    Padding    |</span><br><span class="line">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">|                             Data                              |</span><br><span class="line">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br></pre></td></tr></table></figure>

<ol>
<li>SYN（Synchronize） 作用：用于建立连接。 说明：在三次握手过程的开始阶段，客户端和服务器用 SYN 标志位来同步序列号。客户端发送 SYN 包，服务器回应 SYN&#x2F;ACK 包。</li>
<li>ACK（Acknowledgment） 作用：用于确认接收到的数据。 说明：每一个发送的数据包都会包含一个 ACK 标志位，用来确认已接收到的数据包。ACK 包中包含确认号，表示到目前为止已成功接收的数据字节数。</li>
<li>PSH（Push） 作用：立即发送数据。 说明：当 PSH 标志位被设置时，表示接收方应当立即将数据交给应用层，而不是缓存起来。通常用于实时通信。</li>
<li>FIN（Finish） 作用：用于终止连接。 说明：用来表示发送方已经完成数据发送，并希望关闭连接。四次挥手的终止连接过程中会使用到 FIN 标志位。</li>
<li>RST（Reset） 作用：重置连接。 说明：用于异常情况下重置连接。例如，当接收到一个不期望的包时，接收方可以发送 RST 标志位的包来立即终止连接。</li>
<li>URG（Urgent） 作用：标记紧急数据。 说明：指示报头中紧急指针字段有效，用来指出数据段中某个位置的数据是紧急的，接收方应当优先处理这些紧急数据。</li>
</ol>
<h3 id="TCP-三次握手"><a href="#TCP-三次握手" class="headerlink" title="TCP 三次握手"></a>TCP 三次握手</h3><p>TCP 协议的端口扫描离不开 TCP 协议的三次握手：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Client                                Server</span><br><span class="line">  |                                     |</span><br><span class="line">  | ----------- SYN ------------------&gt; |  (1) 客户端想要建立连接</span><br><span class="line">  |                                     |</span><br><span class="line">  | &lt;--------- SYN/ACK ---------------  |  (2) 服务器确认并同意建立连接</span><br><span class="line">  |                                     |</span><br><span class="line">  | ----------- ACK ------------------&gt; |  (3) 客户端确认连接已建立</span><br><span class="line">  |                                     |</span><br></pre></td></tr></table></figure>

<p>分别是：</p>
<ul>
<li>SYN（同步）：客户端发送 SYN 包请求连接。</li>
<li>SYN-ACK（同步-确认）：服务器收到请求后，回复 SYN-ACK 包。</li>
<li>ACK（确认）：客户端收到 SYN-ACK 包后，发送 ACK 包确认连接建立。</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://web.sqlsec.com/0/assets/1/image-2.png"><br><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219046.png" alt="img"></a></p>
<h3 id="TCP-全开放扫描"><a href="#TCP-全开放扫描" class="headerlink" title="TCP 全开放扫描"></a>TCP 全开放扫描</h3><p>TCP 全开放扫描是一种用于探测目标主机上哪些端口是开放的技术。其原理是通过完整的 TCP 三次握手来确定端口状态。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Scanner (客户端)                          Target (服务器)</span><br><span class="line">  |                                       |</span><br><span class="line">  | ----------- SYN ------------------&gt;   |  (1) 扫描器想要探测端口</span><br><span class="line">  |                                       |</span><br><span class="line">  | &lt;--------- SYN/ACK ---------------    |  (2) 目标端口开放，回应 SYN/ACK</span><br><span class="line">  |                                       |</span><br><span class="line">  | ----------- ACK ------------------&gt;   |  (3) 扫描器确认连接已建立</span><br><span class="line">  |                                       |</span><br><span class="line">  | ----------- RST ------------------&gt;   |  (4) 扫描器立即终止连接</span><br><span class="line">  |                                       |</span><br></pre></td></tr></table></figure>

<p>开放端口：如果目标服务器回应 SYN&#x2F;ACK 包，表示该端口是开放的。<br>关闭端口：如果目标服务器回应 RST 包，表示该端口是关闭的。<br>过滤端口：如果没有回应或回应 ICMP 不可达消息，表示该端口被防火墙或过滤器阻挡。</p>
<p>优点：能够准确地确定端口是否开放。<br>缺点：容易被检测到，因为它会在目标系统上留下连接记录。</p>
<h3 id="TCP-半开放扫描"><a href="#TCP-半开放扫描" class="headerlink" title="TCP 半开放扫描"></a>TCP 半开放扫描</h3><p>TCP 半开放扫描也称为 SYN 扫描，与全开放扫描不同的是，SYN 扫描只进行部分的 TCP 三次握手，从而减少被检测到的风险。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Scanner (客户端)                          Target (服务器)</span><br><span class="line">  |                                       |</span><br><span class="line">  | ----------- SYN ------------------&gt;   |  (1) 扫描器想要探测端口</span><br><span class="line">  |                                       |</span><br><span class="line">  | &lt;--------- SYN/ACK ---------------    |  (2) 目标端口开放，回应 SYN/ACK</span><br><span class="line">  |                                       |</span><br><span class="line">  | ----------- RST ------------------&gt;   |  (3) 扫描器终止连接</span><br><span class="line">  |                                       |</span><br></pre></td></tr></table></figure>

<p>扫描器在接收到 SYN&#x2F;ACK 包后立即发送 RST 包终止连接，而没有完成整个三次握手（没有发送 ACK 包），因此称为半开放扫描。</p>
<p>优点:</p>
<ul>
<li>隐蔽性较高：没有完成三次握手，不会留下完整的连接记录，较难被检测到。</li>
<li>效率较高：比全开放扫描速度快，因为不需要等待三次握手的完成。</li>
</ul>
<p>缺点:</p>
<ul>
<li>防火墙检测：某些防火墙和入侵检测系统（IDS）能够识别并阻止 SYN 扫描。</li>
</ul>
<h3 id="UDP-扫描"><a href="#UDP-扫描" class="headerlink" title="UDP 扫描"></a>UDP 扫描</h3><p>UDP 扫描通过发送 UDP 探测包来检测目标端口的状态。由于 UDP 的无连接特性，判断端口状态的准确率很差。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Scanner (客户端)                          Target (服务器)</span><br><span class="line">  |                                       |</span><br><span class="line">  | ----------- UDP Probe -------------&gt;  |  (1) 扫描器发送 UDP 探测包</span><br><span class="line">  |                                       |</span><br><span class="line">  | &lt;--------- No Response ------------   |  (2a) 目标端口开放，无响应</span><br><span class="line">  |                                       |</span><br><span class="line">  | &lt;--------- ICMP Port Unreachable --   |  (2b) 目标端口关闭，回应不可达消息</span><br><span class="line">  |                                       |</span><br></pre></td></tr></table></figure>

<p>没有收到响应: 端口是开放的或被过滤<br>ICMP 不可达: 明确表示端口是关闭的</p>
<p>优点：隐蔽性较高，由于没有建立连接，不会留下明显的痕迹，较难被检测到。<br>缺点：准确性较低：果需要进一步验证。而且效率较低，探测需要等待超时。</p>
<h3 id="服务端口"><a href="#服务端口" class="headerlink" title="服务端口"></a>服务端口</h3><h4 id="常见-TCP-端口"><a href="#常见-TCP-端口" class="headerlink" title="常见 TCP 端口"></a>常见 TCP 端口</h4><table>
<thead>
<tr>
<th align="left">端口号</th>
<th align="left">服务</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">21</td>
<td align="left">FTP</td>
<td align="left">文件传输协议，用于文件传输。</td>
</tr>
<tr>
<td align="left">22</td>
<td align="left">SSH</td>
<td align="left">安全外壳协议，用于安全登录和数据传输。</td>
</tr>
<tr>
<td align="left">23</td>
<td align="left">Telnet</td>
<td align="left">非安全远程登录协议。</td>
</tr>
<tr>
<td align="left">25</td>
<td align="left">SMTP</td>
<td align="left">简单邮件传输协议，用于电子邮件发送。</td>
</tr>
<tr>
<td align="left">53</td>
<td align="left">DNS</td>
<td align="left">域名系统，用于域名解析。</td>
</tr>
<tr>
<td align="left">80</td>
<td align="left">HTTP</td>
<td align="left">超文本传输协议，用于网页传输。</td>
</tr>
<tr>
<td align="left">110</td>
<td align="left">POP3</td>
<td align="left">邮局协议版本3，用于接收电子邮件。</td>
</tr>
<tr>
<td align="left">143</td>
<td align="left">IMAP</td>
<td align="left">因特网邮件访问协议，用于接收电子邮件。</td>
</tr>
<tr>
<td align="left">443</td>
<td align="left">HTTPS</td>
<td align="left">HTTP 安全协议，使用 SSL&#x2F;TLS 加密的 HTTP。</td>
</tr>
<tr>
<td align="left">445</td>
<td align="left">SMB&#x2F;CIFS</td>
<td align="left">用于 Windows 共享文件和打印服务。</td>
</tr>
<tr>
<td align="left">465</td>
<td align="left">SMTPS</td>
<td align="left">安全的 SMTP，使用 SSL&#x2F;TLS 加密。</td>
</tr>
<tr>
<td align="left">993</td>
<td align="left">IMAPS</td>
<td align="left">安全的 IMAP，使用 SSL&#x2F;TLS 加密。</td>
</tr>
<tr>
<td align="left">995</td>
<td align="left">POP3S</td>
<td align="left">安全的 POP3，使用 SSL&#x2F;TLS 加密。</td>
</tr>
<tr>
<td align="left">1433</td>
<td align="left">Microsoft SQL Server</td>
<td align="left">微软 SQL 服务器数据库服务。</td>
</tr>
<tr>
<td align="left">1521</td>
<td align="left">Oracle</td>
<td align="left">Oracle 数据库服务。</td>
</tr>
<tr>
<td align="left">2181</td>
<td align="left">ZooKeeper</td>
<td align="left">ZooKeeper 默认的端口</td>
</tr>
<tr>
<td align="left">3306</td>
<td align="left">MySQL</td>
<td align="left">MySQL 数据库服务。</td>
</tr>
<tr>
<td align="left">3379</td>
<td align="left">HTTP</td>
<td align="left">Etcd 接口</td>
</tr>
<tr>
<td align="left">3389</td>
<td align="left">RDP</td>
<td align="left">远程桌面协议，用于远程访问 Windows 桌面。</td>
</tr>
<tr>
<td align="left">5000</td>
<td align="left">HTTP</td>
<td align="left">Docker Registry 接口</td>
</tr>
<tr>
<td align="left">5000</td>
<td align="left">HTTP</td>
<td align="left">群晖和威联通 NAS 的 Web 管理端口</td>
</tr>
<tr>
<td align="left">5432</td>
<td align="left">PostgreSQL</td>
<td align="left">PostgreSQL 数据库服务。</td>
</tr>
<tr>
<td align="left">5900</td>
<td align="left">VNC</td>
<td align="left">虚拟网络计算，用于远程桌面访问。</td>
</tr>
<tr>
<td align="left">6066</td>
<td align="left">HTTP</td>
<td align="left">Spark API 接口</td>
</tr>
<tr>
<td align="left">6379</td>
<td align="left">Redis</td>
<td align="left">Redis 数据库服务。</td>
</tr>
<tr>
<td align="left">8060</td>
<td align="left">HTTP</td>
<td align="left">Hadoop YARN resourcemanager 接口</td>
</tr>
<tr>
<td align="left">8080</td>
<td align="left">HTTP</td>
<td align="left">Proxy&#x2F;Alternative 用于代理服务或 HTTP 的备用端口。</td>
</tr>
<tr>
<td align="left">8083</td>
<td align="left">HTTP</td>
<td align="left">InfluxDB API 接口</td>
</tr>
<tr>
<td align="left">8088</td>
<td align="left">HTTP</td>
<td align="left">Hadoop YARN resourcemanager 接口</td>
</tr>
<tr>
<td align="left">8443</td>
<td align="left">HTTPS Alternative</td>
<td align="left">HTTPS 的备用端口。</td>
</tr>
<tr>
<td align="left">9200</td>
<td align="left">HTTP</td>
<td align="left">Elasticsearc h集群端口</td>
</tr>
<tr>
<td align="left">30642</td>
<td align="left">HTTP</td>
<td align="left">Grafana 后台接口</td>
</tr>
</tbody></table>
<h4 id="常见-UDP-端口"><a href="#常见-UDP-端口" class="headerlink" title="常见 UDP 端口"></a>常见 UDP 端口</h4><table>
<thead>
<tr>
<th align="left">端口号</th>
<th align="left">服务</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">53</td>
<td align="left">DNS</td>
<td align="left">DNS 服务器使用 UDP 端口 53 来传输 DNS 查询和响应。</td>
</tr>
<tr>
<td align="left">123</td>
<td align="left">NTP</td>
<td align="left">NTP 服务器使用 UDP 端口 123 来传输时间同步信息。</td>
</tr>
<tr>
<td align="left">161</td>
<td align="left">SNMP</td>
<td align="left">SNMP 服务器使用 UDP 端口 161 来传输网络管理信息。</td>
</tr>
<tr>
<td align="left">67&#x2F;68</td>
<td align="left">DHCP</td>
<td align="left">DHCP 服务器使用 UDP 端口 67 和 68 来传输 DHCP 请求和响应。</td>
</tr>
<tr>
<td align="left">69</td>
<td align="left">TFTP</td>
<td align="left">TFTP 服务器使用 UDP 端口 69 来传输文件。</td>
</tr>
<tr>
<td align="left">514</td>
<td align="left">syslog</td>
<td align="left">syslog 服务器使用 UDP 端口 514 来传输日志信息。</td>
</tr>
<tr>
<td align="left">1812&#x2F;1813</td>
<td align="left">RADIUS</td>
<td align="left">RADIUS 服务器使用 UDP 端口 1812 和 1813 来传输身份验证和授权信息。</td>
</tr>
<tr>
<td align="left">137&#x2F;138</td>
<td align="left">NetBIOS</td>
<td align="left">NetBIOS 服务器使用 UDP 端口 137 和 138 来传输文件和打印机共享信息。</td>
</tr>
</tbody></table>
<h4 id="DNS-端口详解"><a href="#DNS-端口详解" class="headerlink" title="DNS 端口详解"></a>DNS 端口详解</h4><h5 id="协议类型"><a href="#协议类型" class="headerlink" title="协议类型"></a>协议类型</h5><p>DNS 通常使用 UDP 和 TCP两种协议。UDP 协议简单用于 DNS 查询这种小数据包的快速传输。当 DNS 查询需要传输大量数据，例如在区域传输或更新时，就会使用 TCP 协议，这样会数据传输会更可靠性和稳定。</p>
<h5 id="基本概念-1"><a href="#基本概念-1" class="headerlink" title="基本概念"></a>基本概念</h5><p>DNS（Domain Name System 域名系统，当我们在浏览器中输入一个网址（比如 course.sqlsec.com）时，计算机并不知道这个网址对应的服务器在哪里。DNS 协议就像是一个<strong>翻译官</strong>，它负责将我们输入的域名转换为对应的 IP 地址，这样计算机才能找到正确的服务器并与之建立连接，从而获取网页等信息。</p>
<p><a target="_blank" rel="noopener" href="https://web.sqlsec.com/0/assets/1/image-3.png"><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219562.png" alt="img"></a></p>
<h5 id="hosts-文件"><a href="#hosts-文件" class="headerlink" title="hosts 文件"></a>hosts 文件</h5><p>hosts 文件是操作系统中的一个特殊文件，它用于将域名映射到 IP 地址。</p>
<ul>
<li>Windows<ul>
<li><code>C:\Windows\System32\drivers\etc\hosts</code></li>
</ul>
</li>
<li>Linux&#x2F;macOS<ul>
<li><code>/etc/hosts</code></li>
</ul>
</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://web.sqlsec.com/0/assets/1/image-4.png"><br><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406041802484.png" alt="img"></a></p>
<p>hosts 文件允许用户手动添加域名和 IP 地址的映射，这些映射会覆盖 DNS 服务器的解析结果。这意味着，如果一个域名在 hosts 文件中有条目，那么操作系统将直接使用这个映射，而不会去查询 DNS 服务器或者本地 DNS 缓存。</p>
<h5 id="DNS-域传送"><a href="#DNS-域传送" class="headerlink" title="DNS 域传送"></a>DNS 域传送</h5><p>DNS 域传送是指将一个域名从一个 DNS 服务器转移到另一个 DNS 服务器的过程。在这个过程中，源 DNS 服务器将域名的所有权转移到目标 DNS 服务器，目标 DNS 服务器将接管域名的解析和管理。</p>
<p>为什么 DNS 要提供这种功能？主要是为了方便用户进行域名迁移以及容灾备份的时候使用。</p>
<p>DNS 域传输漏洞是指 DNS 服务器配置不当，允许未授权的用户获取该域的所有 DNS 记录，这些记录通常只应由授权的 DNS 服务器访问。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dig axfr vulhub.org @127.0.0.1</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://web.sqlsec.com/0/assets/1/image-5.png"><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219993.png" alt="img"></a></p>
<p>Nmap 也自带了脚本可以直接使用：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap --script dns-zone-transfer.nse --script-args &quot;dns-zone-transfer.domain=vulhub.org&quot; -p 53 127.0.0.1</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://web.sqlsec.com/0/assets/1/image-6.png"><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219781.png" alt="img"></a></p>
<h3 id="掩码长度"><a href="#掩码长度" class="headerlink" title="掩码长度"></a>掩码长度</h3><p>掩码长度是指在 IP 地址中，网络部分的位数。例如，在 192.168.1.1&#x2F;24 中，前 24 位是网络部分，后 8 位是主机部分。</p>
<p>掩码长度可以通过以下公式计算：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">掩码长度 = 32 - log2(主机数)</span><br></pre></td></tr></table></figure>



<p>例如，在 192.168.1.1&#x2F;24 中，主机数为 256（2^8），因此掩码长度为 24。</p>
<p>192.168.1.1&#x2F;24 等于 192.168.1.0-192.168.1.255（256 个 IP 地址）<br>192.168.1.1&#x2F;25 等于 192.168.1.0-192.168.1.127（128 个 IP 地址）<br>192.168.1.1&#x2F;26 等于 192.168.1.0-192.168.1.63（64 个 IP 地址）</p>
<p>不过我们常用的如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">192.168.1.1/16 = 192.168.1.1-192.168.255.255</span><br><span class="line">192.168.1.1/8 = 192.1.1.1-192.255.255.255</span><br></pre></td></tr></table></figure>



<h3 id="扫描工具"><a href="#扫描工具" class="headerlink" title="扫描工具"></a>扫描工具</h3><h4 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h4><p><strong>kali自带</strong></p>
<h5 id="基本操作"><a href="#基本操作" class="headerlink" title="基本操作"></a>基本操作</h5><h6 id="基本快速扫描"><a href="#基本快速扫描" class="headerlink" title="基本快速扫描"></a>基本快速扫描</h6><p>Nmap 默认发送一个 arp 的 ping 数据包，来探测一些常用端口是否开放。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CODE</span><br><span class="line">nmap 10.130.1.43</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://image.3001.net/2017/07/7a99f26738aee77954749946ffde70702.png"><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219829.png" alt="img"></a></p>
<h6 id="快速扫描多个目标"><a href="#快速扫描多个目标" class="headerlink" title="快速扫描多个目标"></a>快速扫描多个目标</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BASHnmap &lt;target ip1 address&gt; &lt;target ip2 address&gt;</span><br><span class="line">nmap 10.130.1.28 10.130.1.43</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://image.3001.net/2017/07/84cf294c80a9769b62c65b2ffc89f8ca2.png"><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219219.png" alt="img"></a></p>
<h6 id="详细描述输出扫描"><a href="#详细描述输出扫描" class="headerlink" title="详细描述输出扫描"></a>详细描述输出扫描</h6><p>简单扫描，并对返回的结果详细描述输出，这个扫描是可以看到扫描的过程的，漫长的扫描的过程中可以看到百分比， 就不会显得那么枯燥，而且可以提升逼格。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CODE</span><br><span class="line">nmap -vv 10.1.1.254</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://image.3001.net/2017/07/2d1cc547df2216922c1e63f628ba6c8c2.png"><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219029.png" alt="img"></a><br>亲测，<code>-v</code> 和 <code>-vv</code> 扫描几乎是一样都，都是列出了详细的扫描过程。</p>
<h6 id="指定端口和范围扫描"><a href="#指定端口和范围扫描" class="headerlink" title="指定端口和范围扫描"></a>指定端口和范围扫描</h6><p>Nmap 默认扫描目标的常见端口号。我们可以通过参数 <code>-p</code> 来指定设置我们将要扫描的端口号：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BASHnmap -p(range) &lt;target IP&gt;</span><br><span class="line">namp -p3389,20-100 10.130.1.43</span><br></pre></td></tr></table></figure>

<h6 id="扫描除过某一个-ip-外的所有子网主机"><a href="#扫描除过某一个-ip-外的所有子网主机" class="headerlink" title="扫描除过某一个 ip 外的所有子网主机"></a>扫描除过某一个 ip 外的所有子网主机</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CODE</span><br><span class="line">nmap 10.130.1.1/24 -exclude 10.130.1.1</span><br></pre></td></tr></table></figure>

<h6 id="扫描除过某一个文件中的-ip-外的子网主机"><a href="#扫描除过某一个文件中的-ip-外的子网主机" class="headerlink" title="扫描除过某一个文件中的 ip 外的子网主机"></a>扫描除过某一个文件中的 ip 外的子网主机</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BASH</span><br><span class="line">nmap 10.130.1.1/24 -excludefile gov.txt</span><br></pre></td></tr></table></figure>

<h6 id="显示扫描的所有主机的列表"><a href="#显示扫描的所有主机的列表" class="headerlink" title="显示扫描的所有主机的列表"></a>显示扫描的所有主机的列表</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BASH</span><br><span class="line">nmap -sL 10.130.1.1/24</span><br></pre></td></tr></table></figure>

<h6 id="sP-ping-扫描"><a href="#sP-ping-扫描" class="headerlink" title="sP ping 扫描"></a>sP ping 扫描</h6><p>Nmap 可以利用类似 Window&#x2F;Linux 系统下的 ping 方式进行扫描</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BASH</span><br><span class="line">nmap -sP &lt;target ip&gt;</span><br></pre></td></tr></table></figure>

<p>一般来说 我们会用这个命令去扫描内网的一个 IP 范围，用来做内网的主机发现。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BASH</span><br><span class="line">nmap -sP 10.130.1.1-255</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://image.3001.net/2017/07/be85970d09cd8416a30de562cb3cc9d22.png"><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219266.png" alt="img"></a><br>PING 扫描不同于其它的扫描方式，因为它只用于找出主机是否是存在在网络中的。它不是用来发现是否开放端口的，PING 扫描需要 ROOT 权限。</p>
<h6 id="sS-SYN-半开放扫描"><a href="#sS-SYN-半开放扫描" class="headerlink" title="sS SYN 半开放扫描"></a>sS SYN 半开放扫描</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BASH</span><br><span class="line">nmap -sS 192.168.1.1</span><br></pre></td></tr></table></figure>

<p>Tcp SYN Scan (sS) 这是一个基本的扫描方式，它被称为半开放扫描，因为这种技术使得 Nmap 不需要通过完整的握手，就能获得远程主机的信息。Nmap 发送 SYN 包到远程主机，但是它不会产生任何会话。因此<strong>不会在目标主机上产生任何日志记录</strong>，因为没有形成会话。这个就是 SYN 扫描的优势，如果 Nmap 命令中没有指出扫描类型，默认的就是 <code>Tcp SYN</code>。但是它同样也需要 <code>root/administrator</code> 权限。</p>
<h6 id="sT-TCP-扫描"><a href="#sT-TCP-扫描" class="headerlink" title="sT TCP 扫描"></a>sT TCP 扫描</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BASH</span><br><span class="line">nmap -sT 192.168.1.1</span><br></pre></td></tr></table></figure>

<p>不同于 Tcp SYN 扫描，Tcp connect () 扫描需要完成三次握手，并且要求调用系统的 connect ().Tcp connect () 扫描技术只适用于找出 TCP 和 UDP 端口。</p>
<h6 id="sU-UDP-扫描"><a href="#sU-UDP-扫描" class="headerlink" title="sU UDP 扫描"></a>sU UDP 扫描</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BASH</span><br><span class="line">nmap -sU 192.168.1.1</span><br></pre></td></tr></table></figure>

<p>这种扫描技术用来寻找目标主机打开的 UDP 端口，它不需要发送任何的 SYN 包，因为这种技术是针对 UDP 端口的。UDP 扫描发送 UDP 数据包到目标主机，并等待响应。如果返回 ICMP 不可达的错误消息，说明端口是关闭的，如果得到正确的适当的回应，说明端口是开放的。</p>
<h6 id="sF-FIN-标志的数据包扫描"><a href="#sF-FIN-标志的数据包扫描" class="headerlink" title="sF FIN 标志的数据包扫描"></a>sF FIN 标志的数据包扫描</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BASH</span><br><span class="line">nmap -sF 110.130.1.43</span><br></pre></td></tr></table></figure>

<p>可以看出这个扫描的话 会漏扫许多，FIN 扫描也不会在目标主机上创建日志（FIN 扫描的优势之一）。这个类型的扫描都是具有差异性的，FIN 扫描发送的包只包含 FIN 标识，NULL 扫描不发送数据包上的任何字节，XMAS 扫描发送 FIN、PSH 和 URG 标识的数据包。</p>
<h6 id="sV-Version-版本检测扫描"><a href="#sV-Version-版本检测扫描" class="headerlink" title="sV Version 版本检测扫描"></a>sV Version 版本检测扫描</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BASH</span><br><span class="line">nmap -sV 192.168.1.135</span><br></pre></td></tr></table></figure>

<p>本检测是用来扫描目标主机和端口上<strong>运行的软件的版本</strong>。它不同于其它的扫描技术，它不是用来扫描目标主机上开放的端口，不过它需要从开放的端口获取信息来判断软件的版本。使用版本检测扫描之前需要先用 TCP SYN 扫描开放了哪些端口。这个扫描的话，速度会慢一些，<code>67.86</code> 秒扫一个 IP。</p>
<h6 id="O-OS-操作系统类型的探测"><a href="#O-OS-操作系统类型的探测" class="headerlink" title="O OS 操作系统类型的探测"></a>O OS 操作系统类型的探测</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BASH</span><br><span class="line">nmap -O 10.130.1.43</span><br></pre></td></tr></table></figure>

<p>远程检测操作系统和软件，Nmap 的 OS 检测技术在渗透测试中用来了解远程主机的操作系统和软件是非常有用的，通过获取的信息你可以知道已知的漏洞。Nmap 有一个名为的 nmap-OS-DB 数据库，该数据库包含超过 2600 种操作系统的信息。Nmap 把 TCP 和 UDP 数据包发送到目标机器上，然后检查结果和数据库对照。</p>
<h6 id="osscan-guess-猜测匹配操作系统"><a href="#osscan-guess-猜测匹配操作系统" class="headerlink" title="osscan-guess 猜测匹配操作系统"></a>osscan-guess 猜测匹配操作系统</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CODE</span><br><span class="line">nmap -O --osscan-guess 192.168.1.134</span><br></pre></td></tr></table></figure>

<p>通过 Nmap 准确的检测到远程操作系统是比较困难的，需要使用到 Nmap 的猜测功能选项，<code>–osscan-guess</code> 猜测认为最接近目标的匹配操作系统类型。</p>
<h5 id="PN-No-ping-扫描"><a href="#PN-No-ping-扫描" class="headerlink" title="PN No ping 扫描"></a>PN No ping 扫描</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BASH</span><br><span class="line">nmap -O -PN 192.168.1.1/24</span><br></pre></td></tr></table></figure>

<p>如果远程主机有防火墙，IDS 和 IPS 系统，你可以使用 -PN 命令来确保不 ping 远程主机，因为有时候防火墙会组织掉 ping 请求。<code>-PN</code> 命令告诉 Nmap 不用 ping 远程主机。有时候使用 <code>-PN</code> 参数可以绕过 PING 命令，但是不影响主机的系统的发现。</p>
<p><a target="_blank" rel="noopener" href="https://image.3001.net/2017/07/a4c9bc8226dd10c95e2dd5dd2525310e2.png"><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406041528194.png" alt="img"></a></p>
<p>这个扫描整个 C 段局域网的话还是比较耗时的，但是信息收集很详细，大概耗时 <code>9</code> 分钟。</p>
<h5 id="T-设置时间模板"><a href="#T-设置时间模板" class="headerlink" title="T 设置时间模板"></a>T 设置时间模板</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BASH</span><br><span class="line">nmap -sS -T&lt;0-5&gt; 192.168.1.134</span><br></pre></td></tr></table></figure>

<p>优化时间控制选项的功能很强大也很有效，但有些用户会被迷惑。此外， 往往选择合适参数的时间超过了所需优化的扫描时间。因此，Nmap 提供了一些简单的 方法，使用 6 个时间模板，使用时采用 - T 选项及数字 (0 - 5) 或名称。模板名称有 <code>paranoid (0)、sneaky (1)、polite (2)、normal(3)、 aggressive (4)和insane (5)</code></p>
<ul>
<li>paranoid、sneaky 模式用于 IDS 躲避</li>
<li>Polite 模式降低了扫描 速度以使用更少的带宽和目标主机资源。</li>
<li>Normal 为默认模式，因此 - T3 实际上是未做任何优化。</li>
<li>Aggressive 模式假设用户具有合适及可靠的网络从而加速扫描.</li>
<li>nsane 模式假设用户具有特别快的网络或者愿意为获得速度而牺牲准确性。</li>
</ul>
<h6 id="网段扫描格式"><a href="#网段扫描格式" class="headerlink" title="网段扫描格式"></a>网段扫描格式</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BASH</span><br><span class="line">nmap -sP &lt;network address &gt; &lt;/CIDR &gt;  </span><br></pre></td></tr></table></figure>

<p>解释：CIDR 为你设置的子网掩码 <code>(/24 , /16 ,/8 等)</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">BASH10.1.1.0/24  =  10.1.1.1-10.1.1.255       # c段扫描</span><br><span class="line">10.1.1.0/16  =  10.1.1.1-10.1.255.255     # b段扫描</span><br><span class="line">10.1.1.0/8   =  10.1.1.1-10.255.255.255   # a段扫描</span><br></pre></td></tr></table></figure>

<h6 id="从文件中读取需要扫描的-IP-列表"><a href="#从文件中读取需要扫描的-IP-列表" class="headerlink" title="从文件中读取需要扫描的 IP 列表"></a>从文件中读取需要扫描的 IP 列表</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BASH</span><br><span class="line">nmap -iL ip-address.txt</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://image.3001.net/2017/07/cc6e92b7ccd9e08e6d1cc3ab449d4d792.png"><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219535.png" alt="img"></a></p>
<h6 id="路由跟踪扫描"><a href="#路由跟踪扫描" class="headerlink" title="路由跟踪扫描"></a>路由跟踪扫描</h6><p>路由器追踪功能，能够帮网络管理员了解网络通行情况，同时也是网络管理人员很好的辅助工具！通过路由器追踪可以轻松的查处从我们电脑所在地到目标地之间所经常的网络节点，并可以看到通过各个节点所花费的时间。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BASH</span><br><span class="line">nmap -traceroute www.baidu.com</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://image.3001.net/2017/07/f2a28889bb2e9cf9998df5be554618052.png"><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219674.png" alt="img"></a></p>
<h6 id="A-OS-识别-版本探测-脚本扫描和-traceroute-综合扫描"><a href="#A-OS-识别-版本探测-脚本扫描和-traceroute-综合扫描" class="headerlink" title="A OS 识别 版本探测 脚本扫描和 traceroute 综合扫描"></a>A OS 识别 版本探测 脚本扫描和 traceroute 综合扫描</h6><p>此选项设置包含了常见的端口 ping 扫描，操作系统扫描，脚本扫描，路由跟踪，服务探测。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BASH</span><br><span class="line">nmap -A 10.130.1.43</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://image.3001.net/2017/07/4dab6997bdc8689a89aa90e792ac08a32.png"><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219529.png" alt="img"></a></p>
<h6 id="命令混合式扫描"><a href="#命令混合式扫描" class="headerlink" title="命令混合式扫描"></a>命令混合式扫描</h6><p>命令混合扫描，可以做到类似参数 <code>-A </code>所完成的功能，但又能细化到我们所需特殊要求。所以一般高手选择这个混合扫描：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BASH</span><br><span class="line">nmap -vv -p1-100,3306,3389 -O -traceroute 10.130.1.43</span><br></pre></td></tr></table></figure>

<p>这些参数都是可以灵活调用的，具体根据具体的扫描来使用各个参数。</p>
<p><a target="_blank" rel="noopener" href="https://image.3001.net/2017/07/00cc7fccb3dc60ebdedbe4e5bb77a9072.png"><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219090.png" alt="img"></a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BASH</span><br><span class="line">nmap -p1-65535 -sV -sS -T4 10.130.1.134</span><br></pre></td></tr></table></figure>

<p>使 <code>SYN</code> 扫描，并进行 Version 版本检测 使用 T4 (aggressive) 的时间模板对目标 IP 的全端口进行扫描。</p>
<h6 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式"></a>输出格式</h6><p>扫描的结果输出到屏幕，同时会存储一份到 grep-output.txt</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BASH</span><br><span class="line">nmap -sV -p 139,445 -oG grep-output.txt 10.0.1.0/24</span><br></pre></td></tr></table></figure>

<p>输出 XML 格式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">S</span><br><span class="line">nmap 10.0.1.0/24 -oX res.xml</span><br></pre></td></tr></table></figure>

<p>扫描结果输出为 HTML 格式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BASH</span><br><span class="line">nmap -sS -sV -T5 10.0.1.99 --webxml -oX - | xsltproc --output file.html</span><br></pre></td></tr></table></figure>

<h5 id="Nmap-高级用法之脚本使用"><a href="#Nmap-高级用法之脚本使用" class="headerlink" title="Nmap 高级用法之脚本使用"></a>Nmap 高级用法之脚本使用</h5><h6 id="按照脚本分类进行扫描"><a href="#按照脚本分类进行扫描" class="headerlink" title="按照脚本分类进行扫描"></a>按照脚本分类进行扫描</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BASH</span><br><span class="line">nmap --script 类别</span><br></pre></td></tr></table></figure>

<p>nmap 官方脚本文档: <a target="_blank" rel="noopener" href="https://nmap.org/nsedoc/">https://nmap.org/nsedoc/</a><br><a target="_blank" rel="noopener" href="https://image.3001.net/2017/07/7822ed61bd955f648b1fae0408c09fa02.png"><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219107.png" alt="img"></a></p>
<p>左侧列出了脚本的分类，点击分类可以看到每一个分类下有很多具体的脚本供我们使用。<br><code>nmap --script=类别</code> 这里的类别，可以填写下面 14 大分类中的其中之一，也可以填写分类里面的具体漏洞扫描脚本。</p>
<p>Nmap 脚本分类:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">VERILOG- auth: 负责处理鉴权证书（绕开鉴权）的脚本  </span><br><span class="line">- broadcast: 在局域网内探查更多服务开启状况，如dhcp/dns/sqlserver等服务  </span><br><span class="line">- brute: 提供暴力破解方式，针对常见的应用如http/snmp等  </span><br><span class="line">- default: 使用-sC或-A选项扫描时候默认的脚本，提供基本脚本扫描能力  </span><br><span class="line">- discovery: 对网络进行更多的信息，如SMB枚举、SNMP查询等  </span><br><span class="line">- dos: 用于进行拒绝服务攻击  </span><br><span class="line">- exploit: 利用已知的漏洞入侵系统  </span><br><span class="line">- external: 利用第三方的数据库或资源，例如进行whois解析  </span><br><span class="line">- fuzzer: 模糊测试的脚本，发送异常的包到目标机，探测出潜在漏洞</span><br><span class="line">- intrusive: 入侵性的脚本，此类脚本可能引发对方的IDS/IPS的记录或屏蔽</span><br><span class="line">- malware: 探测目标机是否感染了病毒、开启了后门等信息  </span><br><span class="line">- safe: 此类与intrusive相反，属于安全性脚本  </span><br><span class="line">- version: 负责增强服务与版本扫描（Version Detection）功能的脚本  </span><br><span class="line">- vuln: 负责检查目标机是否有常见的漏洞（Vulnerability），如是否有MS08_067</span><br></pre></td></tr></table></figure>

<h6 id="使用具体脚本进行扫描"><a href="#使用具体脚本进行扫描" class="headerlink" title="使用具体脚本进行扫描"></a>使用具体脚本进行扫描</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CODE</span><br><span class="line">nmap --script 具体的脚本 www.baidu.com</span><br></pre></td></tr></table></figure>

<h6 id="常用脚本使用案例"><a href="#常用脚本使用案例" class="headerlink" title="常用脚本使用案例"></a>常用脚本使用案例</h6><h6 id="扫描服务器的常见漏洞"><a href="#扫描服务器的常见漏洞" class="headerlink" title="扫描服务器的常见漏洞"></a>扫描服务器的常见漏洞</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BASH</span><br><span class="line">nmap --script vuln &lt;target&gt;</span><br></pre></td></tr></table></figure>

<h6 id="检查-FTP-是否开启匿名登陆"><a href="#检查-FTP-是否开启匿名登陆" class="headerlink" title="检查 FTP 是否开启匿名登陆"></a>检查 FTP 是否开启匿名登陆</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">BASHnmap --script ftp-anon &lt;target&gt;</span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line">21/tcp open  ftp</span><br><span class="line">| ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">| -rw-r--r--   1 1170     924            31 Mar 28  2001 .banner</span><br><span class="line">| d--x--x--x   2 root     root         1024 Jan 14  2002 bin</span><br><span class="line">| d--x--x--x   2 root     root         1024 Aug 10  1999 etc</span><br><span class="line">| drwxr-srwt   2 1170     924          2048 Jul 19 18:48 incoming [NSE: writeable]</span><br><span class="line">| d--x--x--x   2 root     root         1024 Jan 14  2002 lib</span><br><span class="line">| drwxr-sr-x   2 1170     924          1024 Aug  5  2004 pub</span><br><span class="line">|_Only 6 shown. Use --script-args ftp-anon.maxlist=-1 to see all.</span><br></pre></td></tr></table></figure>

<h6 id="对-MySQL-进行暴破解"><a href="#对-MySQL-进行暴破解" class="headerlink" title="对 MySQL 进行暴破解"></a>对 MySQL 进行暴破解</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">BASHnmap --script=mysql-brute &lt;target&gt;</span><br><span class="line">3306/tcp open  mysql</span><br><span class="line">| mysql-brute:</span><br><span class="line">|   Accounts</span><br><span class="line">|     root:root - Valid credentials</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://image.3001.net/2017/07/5bb8e360090ff1da26b303ecf7d5e69e2.png"><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219814.png" alt="img"></a></p>
<p>可以看出已经暴力成功破解了 MySQL, 在 368 秒内进行 45061 次猜测，平均 TPS 为 146.5。</p>
<h6 id="对-MSSQL-进行暴破解"><a href="#对-MSSQL-进行暴破解" class="headerlink" title="对 MSSQL 进行暴破解"></a>对 MSSQL 进行暴破解</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">BASHnmap -p 1433 --script ms-sql-brute --script-args userdb=customuser.txt,passdb=custompass.txt &lt;host&gt;</span><br><span class="line">| ms-sql-brute:</span><br><span class="line">|   [192.168.100.128\TEST]</span><br><span class="line">|     No credentials found</span><br><span class="line">|     Warnings:</span><br><span class="line">|       sa: AccountLockedOut</span><br><span class="line">|   [192.168.100.128\PROD]</span><br><span class="line">|     Credentials found:</span><br><span class="line">|       webshop_reader:secret =&gt; Login Success</span><br><span class="line">|       testuser:secret1234 =&gt; PasswordMustChange</span><br><span class="line">|_      lordvader:secret1234 =&gt; Login Success</span><br></pre></td></tr></table></figure>

<h6 id="对-Oracle-数据库进行暴破解"><a href="#对-Oracle-数据库进行暴破解" class="headerlink" title="对 Oracle 数据库进行暴破解"></a>对 Oracle 数据库进行暴破解</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">BASHnmap --script oracle-brute -p 1521 --script-args oracle-brute.sid=ORCL &lt;host&gt;</span><br><span class="line">PORT     STATE  SERVICE REASON</span><br><span class="line">1521/tcp open  oracle  syn-ack</span><br><span class="line">| oracle-brute:</span><br><span class="line">|   Accounts</span><br><span class="line">|     system:powell =&gt; Account locked</span><br><span class="line">|     haxxor:haxxor =&gt; Valid credentials</span><br><span class="line">|   Statistics</span><br><span class="line">|_    Perfomed 157 guesses in 8 seconds, average tps: 19</span><br></pre></td></tr></table></figure>

<h6 id="对-pgSQL-的暴力破解"><a href="#对-pgSQL-的暴力破解" class="headerlink" title="对 pgSQL 的暴力破解"></a>对 pgSQL 的暴力破解</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">BASHnmap -p 5432 --script pgsql-brute &lt;host&gt;</span><br><span class="line">5432/tcp open  pgsql</span><br><span class="line">| pgsql-brute:</span><br><span class="line">|   root:&lt;empty&gt; =&gt; Valid credentials</span><br><span class="line">|_  test:test =&gt; Valid credentials</span><br></pre></td></tr></table></figure>

<h6 id="对-SSH-进行暴力破解"><a href="#对-SSH-进行暴力破解" class="headerlink" title="对 SSH 进行暴力破解"></a>对 SSH 进行暴力破解</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">BASHnmap -p 22 --script ssh-brute --script-args userdb=users.lst,passdb=pass.lst --script-args ssh-brute.timeout=4s &lt;target&gt;</span><br><span class="line">22/ssh open  ssh</span><br><span class="line">| ssh-brute:</span><br><span class="line">|  Accounts</span><br><span class="line">|    username:password</span><br><span class="line">|  Statistics</span><br><span class="line">|_   Performed 32 guesses in 25 seconds.</span><br></pre></td></tr></table></figure>

<h6 id="利用-DNS-进行子域名暴力破解"><a href="#利用-DNS-进行子域名暴力破解" class="headerlink" title="利用 DNS 进行子域名暴力破解"></a>利用 DNS 进行子域名暴力破解</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">BASHnmap --script dns-brute www.baidu.com</span><br><span class="line">λ nmap --script dns-brute www.baidu.com                      </span><br><span class="line"></span><br><span class="line">Starting Nmap 7.50 ( https://nmap.org ) at 2017-07-25 13:12 ?</span><br><span class="line">Nmap scan report for www.baidu.com (180.97.33.108)           </span><br><span class="line">Host is up (0.018s latency).                                 </span><br><span class="line">Other addresses for www.baidu.com (not scanned): 180.97.33.10</span><br><span class="line">Not shown: 998 filtered ports                                </span><br><span class="line">PORT    STATE SERVICE                                        </span><br><span class="line">80/tcp  open  http                                           </span><br><span class="line">443/tcp open  https                                          </span><br><span class="line"></span><br><span class="line">Host script results:                                         </span><br><span class="line">| dns-brute:                                                 </span><br><span class="line">|   DNS Brute-force hostnames:                               </span><br><span class="line">|     admin.baidu.com - 10.26.109.19                         </span><br><span class="line">|     mx.baidu.com - 61.135.163.61                           </span><br><span class="line">|     svn.baidu.com - 10.65.211.174                          </span><br><span class="line">|     ads.baidu.com - 10.42.4.225                                                </span><br><span class="line"></span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 92.64 seconds</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://image.3001.net/2017/07/45502ec7e0f8a0c49ca64b866248819c2.png"><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219117.png" alt="img"></a></p>
<p>额 (⊙﹏⊙) 这个 <code>admin.baidu.com</code> 后面那个 <code>10.26.109.19</code> 难道真的是百度内网的管理平台地址？</p>
<h6 id="检查-VMWare-ESX，ESXi-和服务器（CVE-2009-3733）中的路径遍历漏洞"><a href="#检查-VMWare-ESX，ESXi-和服务器（CVE-2009-3733）中的路径遍历漏洞" class="headerlink" title="检查 VMWare ESX，ESXi 和服务器（CVE-2009-3733）中的路径遍历漏洞"></a>检查 VMWare ESX，ESXi 和服务器（CVE-2009-3733）中的路径遍历漏洞</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">BASHnmap --script http-vmware-path-vuln -p80,443,8222,8333 &lt;host&gt;</span><br><span class="line">| http-vmware-path-vuln:</span><br><span class="line">|   VMWare path traversal (CVE-2009-3733): VULNERABLE</span><br><span class="line">|     /vmware/Windows 2003/Windows 2003.vmx</span><br><span class="line">|     /vmware/Pentest/Pentest - Linux/Linux Pentest Bravo.vmx</span><br><span class="line">|     /vmware/Pentest/Pentest - Windows/Windows 2003.vmx</span><br><span class="line">|     /mnt/vmware/vmware/FreeBSD 7.2/FreeBSD 7.2.vmx</span><br><span class="line">|     /mnt/vmware/vmware/FreeBSD 8.0/FreeBSD 8.0.vmx</span><br><span class="line">|     /mnt/vmware/vmware/FreeBSD 8.0 64-bit/FreeBSD 8.0 64-bit.vmx</span><br><span class="line">|_    /mnt/vmware/vmware/Slackware 13 32-bit/Slackware 13 32-bit.vmx</span><br></pre></td></tr></table></figure>

<h6 id="查询-VMware-服务器（vCenter，ESX，ESXi）SOAP-API-以提取版本信息。"><a href="#查询-VMware-服务器（vCenter，ESX，ESXi）SOAP-API-以提取版本信息。" class="headerlink" title="查询 VMware 服务器（vCenter，ESX，ESXi）SOAP API 以提取版本信息。"></a>查询 VMware 服务器（vCenter，ESX，ESXi）SOAP API 以提取版本信息。</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">BASHλ nmap --script vmware-version -p443 10.0.1.4</span><br><span class="line"></span><br><span class="line">Starting Nmap 7.50 ( https://nmap.org ) at 2017-07-25 12:26 ?D1ú±ê×?ê±??</span><br><span class="line">Nmap scan report for 10.0.1.4</span><br><span class="line">Host is up (0.0019s latency).</span><br><span class="line"></span><br><span class="line">PORT    STATE SERVICE</span><br><span class="line">443/tcp open  https</span><br><span class="line">| vmware-version:</span><br><span class="line">|   Server version: VMware ESXi 6.5.0</span><br><span class="line">|   Build: 4887370</span><br><span class="line">|   Locale version: INTL 000</span><br><span class="line">|   OS type: vmnix-x86</span><br><span class="line">|_  Product Line ID: embeddedEsx</span><br><span class="line">Service Info: CPE: cpe:/o:vmware:ESXi:6.5.0</span><br><span class="line"></span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 6.28 seconds</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://image.3001.net/2017/07/7ec5b1b3ec0ba3ee2d1587b17de0e8b92.png"><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219302.png" alt="img"></a></p>
<h5 id="参数详解"><a href="#参数详解" class="headerlink" title="参数详解"></a>参数详解</h5><p>Nmap 支持主机名，网段的表示方式<br>例如:<code>blah.highon.coffee, namp.org/24, 192.168.0.1;10.0.0-25.1-254</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">VERILOG-iL filename                    从文件中读取待检测的目标,文件中的表示方法支持机名,ip,网段</span><br><span class="line">-iR hostnum                     随机选取,进行扫描.如果-iR指定为0,则是无休止的扫描</span><br><span class="line">--exclude host1[, host2]        从扫描任务中需要排除的主机           </span><br><span class="line">--exculdefile exclude_file      排除文件中的IP,格式和-iL指定扫描文件的格式相同</span><br></pre></td></tr></table></figure>

<h6 id="主机发现"><a href="#主机发现" class="headerlink" title="主机发现"></a>主机发现</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">VERILOG-sL                     仅仅是显示,扫描的IP数目,不会进行任何扫描</span><br><span class="line">-sn                     ping扫描,即主机发现</span><br><span class="line">-Pn                     不检测主机存活</span><br><span class="line">-PS/PA/PU/PY[portlist]  TCP SYN Ping/TCP ACK Ping/UDP Ping发现</span><br><span class="line">-PE/PP/PM               使用ICMP echo, timestamp and netmask 请求包发现主机</span><br><span class="line">-PO[prococol list]      使用IP协议包探测对方主机是否开启   </span><br><span class="line">-n/-R                   不对IP进行域名反向解析/为所有的IP都进行域名的反响解析</span><br></pre></td></tr></table></figure>

<h6 id="扫描技巧"><a href="#扫描技巧" class="headerlink" title="扫描技巧"></a>扫描技巧</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">VERILOG-sS/sT/sA/sW/sM                 TCP SYN/TCP connect()/ACK/TCP窗口扫描/TCP Maimon扫描</span><br><span class="line">-sU                             UDP扫描</span><br><span class="line">-sN/sF/sX                       TCP Null，FIN，and Xmas扫描</span><br><span class="line">--scanflags                     自定义TCP包中的flags</span><br><span class="line">-sI zombie host[:probeport]     Idlescan</span><br><span class="line">-sY/sZ                          SCTP INIT/COOKIE-ECHO 扫描</span><br><span class="line">-sO                             使用IP protocol 扫描确定目标机支持的协议类型</span><br><span class="line">-b “FTP relay host”             使用FTP bounce scan</span><br></pre></td></tr></table></figure>

<h6 id="指定端口和扫描顺序"><a href="#指定端口和扫描顺序" class="headerlink" title="指定端口和扫描顺序"></a>指定端口和扫描顺序</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">VERILOG-p                      特定的端口 -p80,443 或者 -p1-65535</span><br><span class="line">-p U:PORT               扫描udp的某个端口, -p U:53</span><br><span class="line">-F                      快速扫描模式,比默认的扫描端口还少</span><br><span class="line">-r                      不随机扫描端口,默认是随机扫描的</span><br><span class="line">--top-ports &quot;number&quot;    扫描开放概率最高的number个端口,出现的概率需要参考nmap-services文件,ubuntu中该文件位于/usr/share/nmap.nmap默认扫前1000个</span><br><span class="line">--port-ratio &quot;ratio&quot;    扫描指定频率以上的端口</span><br></pre></td></tr></table></figure>

<h6 id="服务版本识别"><a href="#服务版本识别" class="headerlink" title="服务版本识别"></a>服务版本识别</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">VERILOG-sV                             开放版本探测,可以直接使用-A同时打开操作系统探测和版本探测</span><br><span class="line">--version-intensity &quot;level&quot;     设置版本扫描强度,强度水平说明了应该使用哪些探测报文。数值越高，服务越有可能被正确识别。默认是7</span><br><span class="line">--version-light                 打开轻量级模式,为--version-intensity 2的别名</span><br><span class="line">--version-all                   尝试所有探测,为--version-intensity 9的别名</span><br><span class="line">--version-trace                 显示出详细的版本侦测过程信息</span><br></pre></td></tr></table></figure>

<h6 id="脚本扫描"><a href="#脚本扫描" class="headerlink" title="脚本扫描"></a>脚本扫描</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">VERILOG-sC                             根据端口识别的服务,调用默认脚本</span><br><span class="line">--script=”Lua scripts”          调用的脚本名</span><br><span class="line">--script-args=n1=v1,[n2=v2]     调用的脚本传递的参数</span><br><span class="line">--script-args-file=filename     使用文本传递参数</span><br><span class="line">--script-trace                  显示所有发送和接收到的数据</span><br><span class="line">--script-updatedb               更新脚本的数据库</span><br><span class="line">--script-help=”Lua script”      显示指定脚本的帮助</span><br></pre></td></tr></table></figure>

<h6 id="OS-识别"><a href="#OS-识别" class="headerlink" title="OS 识别"></a>OS 识别</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">VERILOG-O              启用操作系统检测,-A来同时启用操作系统检测和版本检测</span><br><span class="line">--osscan-limit  针对指定的目标进行操作系统检测(至少需确知该主机分别有一个open和closed的端口)</span><br><span class="line">--osscan-guess  推测操作系统检测结果,当Nmap无法确定所检测的操作系统时，会尽可能地提供最相近的匹配，Nmap默认进行这种匹配</span><br></pre></td></tr></table></figure>

<h6 id="防火墙-IDS-躲避和哄骗"><a href="#防火墙-IDS-躲避和哄骗" class="headerlink" title="防火墙 &#x2F; IDS 躲避和哄骗"></a>防火墙 &#x2F; IDS 躲避和哄骗</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">VERILOG-f; --mtu value                 指定使用分片、指定数据包的MTU.</span><br><span class="line">-D decoy1,decoy2,ME             使用诱饵隐蔽扫描</span><br><span class="line">-S IP-ADDRESS                   源地址欺骗</span><br><span class="line">-e interface                    使用指定的接口</span><br><span class="line">-g/ --source-port PROTNUM       使用指定源端口  </span><br><span class="line">--proxies url1,[url2],...       使用HTTP或者SOCKS4的代理</span><br><span class="line"></span><br><span class="line">--data-length NUM               填充随机数据让数据包长度达到NUM</span><br><span class="line">--ip-options OPTIONS            使用指定的IP选项来发送数据包</span><br><span class="line">--ttl VALUE                     设置IP time-to-live域</span><br><span class="line">--spoof-mac ADDR/PREFIX/VEBDOR  MAC地址伪装</span><br><span class="line">--badsum                        使用错误的checksum来发送数据包</span><br></pre></td></tr></table></figure>

<h6 id="Nmap-输出"><a href="#Nmap-输出" class="headerlink" title="Nmap 输出"></a>Nmap 输出</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">VERILOG-oN                     将标准输出直接写入指定的文件</span><br><span class="line">-oX                     输出xml文件</span><br><span class="line">-oS                     将所有的输出都改为大写</span><br><span class="line">-oG                     输出便于通过bash或者perl处理的格式,非xml</span><br><span class="line">-oA BASENAME            可将扫描结果以标准格式、XML格式和Grep格式一次性输出</span><br><span class="line">-v                      提高输出信息的详细度</span><br><span class="line">-d level                设置debug级别,最高是9</span><br><span class="line">--reason                显示端口处于带确认状态的原因</span><br><span class="line">--open                  只输出端口状态为open的端口</span><br><span class="line">--packet-trace          显示所有发送或者接收到的数据包</span><br><span class="line">--iflist                显示路由信息和接口,便于调试</span><br><span class="line">--log-errors            把日志等级为errors/warings的日志输出</span><br><span class="line">--append-output         追加到指定的文件</span><br><span class="line">--resume FILENAME       恢复已停止的扫描</span><br><span class="line">--stylesheet PATH/URL   设置XSL样式表，转换XML输出</span><br><span class="line">--webxml                从namp.org得到XML的样式</span><br><span class="line">--no-sytlesheet         忽略XML声明的XSL样式表</span><br></pre></td></tr></table></figure>

<h6 id="其他-Nmap-选项"><a href="#其他-Nmap-选项" class="headerlink" title="其他 Nmap 选项"></a>其他 Nmap 选项</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">VERILOG-6                      开启IPv6</span><br><span class="line">-A                      OS识别,版本探测,脚本扫描和traceroute</span><br><span class="line">--datedir DIRNAME       说明用户Nmap数据文件位置</span><br><span class="line">--send-eth / --send-ip  使用原以太网帧发送/在原IP层发送</span><br><span class="line">--privileged            假定用户具有全部权限</span><br><span class="line">--unprovoleged          假定用户不具有全部权限,创建原始套接字需要root权限</span><br><span class="line">-V                      打印版本信息</span><br><span class="line">-h                      输出帮助</span><br></pre></td></tr></table></figure>

<h4 id="Masscan"><a href="#Masscan" class="headerlink" title="Masscan"></a>Masscan</h4><p>Masscan 是和 Nmap 差不多的端口扫描工具，兼容 Nmap 的命令，且他更简单占用小，扫描速度更快，常用于庞大的资产快速扫描。</p>
<p>常用的命令如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># C 段 指定端口扫描</span><br><span class="line">masscan -p80,443 192.168.1.0/24</span><br><span class="line"></span><br><span class="line"># 查看兼容 Nmap 的参数</span><br><span class="line">masscan --nmap</span><br><span class="line"></span><br><span class="line"># 生成随机 ip</span><br><span class="line">masscan -sL 10.0.0.0/24 &gt; c段.txt</span><br><span class="line">masscan -sL 10.0.0.0/16 &gt; b段.txt</span><br><span class="line">masscan -sL 10.0.0.0/8  &gt; a段.txt</span><br></pre></td></tr></table></figure>

<h4 id="其他工具"><a href="#其他工具" class="headerlink" title="其他工具"></a>其他工具</h4><p>在GG的内网工具栏里</p>
<p><a target="_blank" rel="noopener" href="https://download.web.sqlsec.com/">https://download.web.sqlsec.com/</a></p>
<h3 id="GG靶场实战"><a href="#GG靶场实战" class="headerlink" title="GG靶场实战"></a>GG靶场实战</h3><p><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219603.png" alt="image-20240604154705599"></p>
<p>首先用nmap扫描给定的IP<strong>172.10.100.106</strong>地址，扫描出<strong>53端口</strong></p>
<p><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219398.png" alt="image-20240604153503502"></p>
<p>通过网上搜索，53端口有DNS域渗透。</p>
<p>直接使用 <strong>nmap</strong> 或者 <strong>dig 命令</strong>的直接查询该 DNS 的 sqlsec.com 相关子域名的解析情况</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dig axfr sqlsec.com @172.10.100.106</span><br><span class="line"></span><br><span class="line">nmap --script dns-zone-transfer.nse --script-args &quot;dns-zone-transfer.domain=sqlsec.com&quot; -p 53 172.10.100.106</span><br></pre></td></tr></table></figure>

<p>这里涉及dig 一个重要的命令axfr，axfr 是q-type类型的一种，axfr类型是Authoritative Transfer的缩写，指请求传送某个区域的全部记录。</p>
<p>我们只要欺骗dns服务器发送一个axfr请求过去，如果该dns服务器上存在该漏洞，就会返回所有的解析记录值。</p>
<p><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219162.png" alt="image-20240604155209226"></p>
<p>看到有个<strong>172.10.100.105</strong>，这个很有可能就是我们要找的地址</p>
<p>先ping一下，不通，使用<strong>PN No ping 扫描</strong>，绕过ping命令</p>
<p><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219354.png" alt="image-20240604155603457"></p>
<p>果然是开启了防火墙， 在找到靶机，且对外开放3389端口后，我们首先要测试漏洞是否存在，再考虑是否进行下一步的攻击：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">msfconsole</span><br><span class="line">reload_all</span><br><span class="line">search 0708</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219533.png" alt="image-20240604160229519"></p>
<p>从这里可以知道，这个IP一定是可以利用的。</p>
<p>直接 nmap 对 172.10.100.105 资产进行全端口扫描</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nmap 172.10.100.105 -Pn -p 1-65535   (很慢)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219073.png" alt="img"></p>
<p>扫出60996端口。进去看看</p>
<p><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219747.png" alt="image-20240604161516800"></p>
<p>一个everything页面。</p>
<h3 id="Everything-基本使用"><a href="#Everything-基本使用" class="headerlink" title="Everything 基本使用"></a>Everything 基本使用</h3><p>Everythin Web 服务很强大，基本上可以把 Windows 系统内的文件翻个底朝天，在翻之前我们来简单了解一下两个常用的语法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 根据时间搜索文件</span><br><span class="line">搜索2024年的文件 ： dm:2024</span><br><span class="line">搜索2024年6月份的文件 ： dm:2024/6</span><br><span class="line">搜索2024年6月份01号的文件 ： dm:2024/6/1</span><br><span class="line">搜索2024年6月份01号20点10分的文件 ： dm:2024/6/1，20:10</span><br><span class="line"></span><br><span class="line"># 搜索文本数据</span><br><span class="line">content:sqlsec</span><br></pre></td></tr></table></figure>

<p>更多 Everything 语法</p>
<p>可以参考 Everything 官方文档：</p>
<p><a target="_blank" rel="noopener" href="https://www.voidtools.com/zh-cn/support/everything/searching/">https://www.voidtools.com/zh-cn/support/everything/searching/</a></p>
<p>其实就通过上面两个基本语法组合，结合国光在群里透露的信息：</p>
<ol>
<li>flag 是 sqlsec{xxxxxx} 这种形式</li>
<li>国光是 6月1日 做好靶场的</li>
</ol>
<p>哪怕没想到 Google Chrome 凭据窃取，基本上也可以大差不差定位到相关文件了：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dm:2024/6/1 content:sqlsec</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219746.png" alt="image-20240604161746338"></p>
<h3 id="常规信息搜集"><a href="#常规信息搜集" class="headerlink" title="常规信息搜集"></a>常规信息搜集</h3><p>先看用户下载的软件，然后再针对它下载的软件去找。再看看桌面、浏览器、qq、微信等。常见的有 xshell 密码配置，QQ 微信聊天记录，还有 向日葵远控配置 可以读出密码直接连</p>
<h4 id="解法一：Chrome-密码凭据"><a href="#解法一：Chrome-密码凭据" class="headerlink" title="解法一：Chrome 密码凭据"></a>解法一：Chrome 密码凭据</h4><p>首先为什么会想到 Chrome 呢？首先投机取巧通过下载记录，发现国光这个 Windows 的 Everything 和 Chrome 安装包还在呢？所以大概率考点和 Chrome 相关：</p>
<p><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219766.png" alt="image-20240604162159868"></p>
<p><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219770.png" alt="image-20240604162218378"></p>
<p>另一反面，通过发现了 Chrome 的文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\&#123;User&#125;\AppData\Local\Google\Chrome\User Data\Default</span><br></pre></td></tr></table></figure>

<p>确实也发现了 Chrome 浏览器活跃的迹象。</p>
<p>实战的情况下我们发现浏览器第一时间就应该想到窃取浏览器保存的凭据，因为很多人都有这个直接将密码保存在浏览器里面的习惯，所以我们直接下载 Chrome 的凭据文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\&#123;User&#125;\AppData\Local\Google\Chrome\User Data\Default\Login Data</span><br></pre></td></tr></table></figure>

<p>通过经验或者通过 Hex 编辑器或者通过 file 命令我们可以轻易知道这个凭据文件是个 SQLite 数据库文件：</p>
<p><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219449.png" alt="image-20240604163016814"></p>
<p><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219631.png" alt="img"></p>
<p>直接在navicat 里边导入，可以找到网址和数据库名称</p>
<p><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219109.png" alt="image-20240604163343245"></p>
<ul>
<li>登录地址：<a target="_blank" rel="noopener" href="https://tip.sqlsec.com/user/username-login">https://tip.sqlsec.com/user/username-login</a></li>
<li>保存的用户名：flag_is_here</li>
<li>保存的密码：Chrome 加密存储了，配合一定条件可以解密（挖坑 等GG的文章）</li>
</ul>
<p>社区网站开启防爆破了，输错几次密码就锁定了，再结合国光提示说作为第一节课不会考察爆破和复杂的漏洞利用，基本上都是课程里面学到的，所以这里弱口令天赋与灵感，直接使用 12345678 成功登录：</p>
<p><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219809.png" alt="image-20240604163603639"></p>
<p>登录后把可以点击的功能都点击一遍，最终在「我的草稿箱」：</p>
<p><a target="_blank" rel="noopener" href="https://web.sqlsec.com/attack/assets/1/image-12.png"><img src="https://web.sqlsec.com/attack/assets/1/image-12.png" alt="img"></a></p>
<p>发现了最终的 flag 信息：</p>
<p><a target="_blank" rel="noopener" href="https://web.sqlsec.com/attack/assets/1/image-13.png"><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219575.png" alt="img"></a></p>
<p>信息搜集真的是需要耐心，一点一点慢慢挖</p>
<h4 id="解法二：逆天弱口令天赋"><a href="#解法二：逆天弱口令天赋" class="headerlink" title="解法二：逆天弱口令天赋"></a>解法二：逆天弱口令天赋</h4><p>默认情况下我们直接 RDP 登录是要弹窗的：</p>
<p><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219983.png" alt="image-20240604165714493"></p>
<p>这样啥有用的信息也获取不到。</p>
<p>直接祭出大杀器。古老的 Windows Server 2003 自带的的远程桌面来连接，发现默认的 Administrator 用户是不存在的：</p>
<p><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219380.png" alt="img"></p>
<p>古老的 Windows Server 2003 自带的的远程桌面来连接，使用空用户名来连接，也可以看到存活的用户是 Win，而且这种古老的 RDP 客户端也可以直接看到用户密码提示：</p>
<p><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219345.png" alt="img"></p>
<p>直接逆天弱口令天赋爆表使用经典的弱口令 <strong>P@ssw0rd</strong> 直接登录，直接使用 Chrome 翻出保存的密码：</p>
<p><a target="_blank" rel="noopener" href="https://web.sqlsec.com/attack/assets/1/image-18.png"><img src="https://gitee.com/kd-stroke-king/lem0n-picgo/raw/master/master/202406221219542.png" alt="img"></a></p>
<h2 id="坑点总结"><a href="#坑点总结" class="headerlink" title="坑点总结"></a>坑点总结</h2><ul>
<li>105 IP开启防火墙了需要手动 -Pn 扫描</li>
<li>105 IP 的 60996 高端口需要全端口扫描</li>
<li>Chrome 保存的密码实际上是弱口令，需要大胆尝试</li>
<li>RDP 其实也是弱口令，理应可以尝试出来</li>
<li>学的越多，可能困扰考虑的越多，缺乏行动实践</li>
</ul>
<p>靶场总结一下，首先拿到目标IP和域名，先Nmap 开扫一遍，看有没有什么特别的端口，接着根据端口信息，本次靶机是53端口的DNS域渗透，看DNS 的子域名，拿到172.10.100.105，接着对该域名进行no ping 扫描，看有无防火墙和漏洞，接着进行全端口扫描，拿到该域名的可疑端口60096，通过everything，找到该靶机安装的google浏览器的密码信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\&#123;User&#125;\AppData\Local\Google\Chrome\User Data\Default\Login Data</span><br></pre></td></tr></table></figure>

<p>在该文件中翻出登陆的网站和用户名，密码为弱密码（实战中可能不好弄出来，Chrome 加密存储），然后登陆进去拿到flag</p>
<p>第二种方法是用windows server 2003的远程连接来登陆主机，可以绕过主机的登陆限制，直接进google浏览器拿到用户名和密码，找到flag.</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E4%B8%BB%E5%8A%A8%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/" rel="tag"># 主动信息收集</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/062221050.html" rel="prev" title="指纹识别">
                  <i class="fa fa-angle-left"></i> 指纹识别
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Glock.09</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">19k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">18 分钟</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/Lem0nkdking" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  





</body>
</html>
